
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <title>Tool Call and Function Call Message Handling Â· Agentic Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 6.0.3">
        <meta name="author" content="AutoGen Team">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/@honkit/honkit-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../multimodal-and-vision-capabilities/" />
    
    
    <link rel="prev" href="structured-output-formatting.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../foundations-of-agents-and-messages/">
            
                <a href="../foundations-of-agents-and-messages/">
            
                    
                        <b>1.2.</b>
                    
                    Foundations of Agents and Messages
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../foundations-of-agents-and-messages/agent-protocol.html">
            
                <a href="../foundations-of-agents-and-messages/agent-protocol.html">
            
                    
                        <b>1.2.1.</b>
                    
                    Agent Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../foundations-of-agents-and-messages/llmagent.html">
            
                <a href="../foundations-of-agents-and-messages/llmagent.html">
            
                    
                        <b>1.2.2.</b>
                    
                    LLMAgent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../foundations-of-agents-and-messages/conversableagent.html">
            
                <a href="../foundations-of-agents-and-messages/conversableagent.html">
            
                    
                        <b>1.2.3.</b>
                    
                    ConversableAgent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../foundations-of-agents-and-messages/basemessage-and-message-serialization.html">
            
                <a href="../foundations-of-agents-and-messages/basemessage-and-message-serialization.html">
            
                    
                        <b>1.2.4.</b>
                    
                    BaseMessage and message serialization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../conversable-agent-workflow/">
            
                <a href="../conversable-agent-workflow/">
            
                    
                        <b>1.3.</b>
                    
                    Conversable Agent Workflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../conversable-agent-workflow/reply-function-registration.html">
            
                <a href="../conversable-agent-workflow/reply-function-registration.html">
            
                    
                        <b>1.3.1.</b>
                    
                    Reply function registration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../conversable-agent-workflow/chat-message-flow.html">
            
                <a href="../conversable-agent-workflow/chat-message-flow.html">
            
                    
                        <b>1.3.2.</b>
                    
                    Chat message flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../conversable-agent-workflow/human-input-modes.html">
            
                <a href="../conversable-agent-workflow/human-input-modes.html">
            
                    
                        <b>1.3.3.</b>
                    
                    Human input modes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tools-and-dependency-injection/">
            
                <a href="../tools-and-dependency-injection/">
            
                    
                        <b>1.4.</b>
                    
                    Tools and Dependency Injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../tools-and-dependency-injection/tool-abstraction.html">
            
                <a href="../tools-and-dependency-injection/tool-abstraction.html">
            
                    
                        <b>1.4.1.</b>
                    
                    Tool abstraction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../tools-and-dependency-injection/toolkit.html">
            
                <a href="../tools-and-dependency-injection/toolkit.html">
            
                    
                        <b>1.4.2.</b>
                    
                    Toolkit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../tools-and-dependency-injection/dependency-injection-with-depends.html">
            
                <a href="../tools-and-dependency-injection/dependency-injection-with-depends.html">
            
                    
                        <b>1.4.3.</b>
                    
                    Dependency injection with Depends
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../tools-and-dependency-injection/context-parameter-injection.html">
            
                <a href="../tools-and-dependency-injection/context-parameter-injection.html">
            
                    
                        <b>1.4.4.</b>
                    
                    Context parameter injection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../llm-configuration-and-model-clients/">
            
                <a href="../llm-configuration-and-model-clients/">
            
                    
                        <b>1.5.</b>
                    
                    LLM Configuration and Model Clients
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../llm-configuration-and-model-clients/llmconfig-and-llmconfigentry.html">
            
                <a href="../llm-configuration-and-model-clients/llmconfig-and-llmconfigentry.html">
            
                    
                        <b>1.5.1.</b>
                    
                    LLMConfig and LLMConfigEntry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../llm-configuration-and-model-clients/modelclient-protocol.html">
            
                <a href="../llm-configuration-and-model-clients/modelclient-protocol.html">
            
                    
                        <b>1.5.2.</b>
                    
                    ModelClient protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../llm-configuration-and-model-clients/config-list-and-filtering.html">
            
                <a href="../llm-configuration-and-model-clients/config-list-and-filtering.html">
            
                    
                        <b>1.5.3.</b>
                    
                    Config list and filtering
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../advanced-agent-orchestration/">
            
                <a href="../advanced-agent-orchestration/">
            
                    
                        <b>1.6.</b>
                    
                    Advanced Agent Orchestration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../advanced-agent-orchestration/agent-orchestration-patterns.md">
            
                <span>
            
                    
                        <b>1.6.1.</b>
                    
                    Agent orchestration patterns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../advanced-agent-orchestration/multi-agent-workflows.md">
            
                <span>
            
                    
                        <b>1.6.2.</b>
                    
                    Multi-agent workflows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../advanced-agent-orchestration/agent-state-management.md">
            
                <span>
            
                    
                        <b>1.6.3.</b>
                    
                    Agent state management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../context-variables-and-conditional-logic/">
            
                <a href="../context-variables-and-conditional-logic/">
            
                    
                        <b>1.7.</b>
                    
                    Context Variables and Conditional Logic
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../context-variables-and-conditional-logic/contextvariables.html">
            
                <a href="../context-variables-and-conditional-logic/contextvariables.html">
            
                    
                        <b>1.7.1.</b>
                    
                    ContextVariables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../context-variables-and-conditional-logic/contextcondition-and-availablecondition.html">
            
                <a href="../context-variables-and-conditional-logic/contextcondition-and-availablecondition.html">
            
                    
                        <b>1.7.2.</b>
                    
                    ContextCondition and AvailableCondition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../context-variables-and-conditional-logic/oncondition-and-oncontextcondition.html">
            
                <a href="../context-variables-and-conditional-logic/oncondition-and-oncontextcondition.html">
            
                    
                        <b>1.7.3.</b>
                    
                    OnCondition and OnContextCondition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../context-variables-and-conditional-logic/contextexpression.html">
            
                <a href="../context-variables-and-conditional-logic/contextexpression.html">
            
                    
                        <b>1.7.4.</b>
                    
                    ContextExpression
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../tool-and-function-interoperability/">
            
                <a href="../tool-and-function-interoperability/">
            
                    
                        <b>1.8.</b>
                    
                    Tool and Function Interoperability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../tool-and-function-interoperability/tool-and-function-schemas.md">
            
                <span>
            
                    
                        <b>1.8.1.</b>
                    
                    Tool and function schemas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../tool-and-function-interoperability/function-calling-with-llms.md">
            
                <span>
            
                    
                        <b>1.8.2.</b>
                    
                    Function calling with LLMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../tool-and-function-interoperability/tool-execution-and-validation.md">
            
                <span>
            
                    
                        <b>1.8.3.</b>
                    
                    Tool execution and validation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../retrieval-augmented-generation-and-vector-databases/">
            
                <a href="../retrieval-augmented-generation-and-vector-databases/">
            
                    
                        <b>1.9.</b>
                    
                    Retrieval Augmented Generation and Vector Databases
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../retrieval-augmented-generation-and-vector-databases/rag-fundamentals.md">
            
                <span>
            
                    
                        <b>1.9.1.</b>
                    
                    RAG fundamentals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../retrieval-augmented-generation-and-vector-databases/vector-database-integration.md">
            
                <span>
            
                    
                        <b>1.9.2.</b>
                    
                    Vector database integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../retrieval-augmented-generation-and-vector-databases/rag-optimization.md">
            
                <span>
            
                    
                        <b>1.9.3.</b>
                    
                    RAG optimization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.10.</b>
                    
                    Structured Outputs and Tool Calling with LLMs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="function-and-tool-schemas.html">
            
                <a href="function-and-tool-schemas.html">
            
                    
                        <b>1.10.1.</b>
                    
                    Function and Tool schemas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="structured-output-formatting.html">
            
                <a href="structured-output-formatting.html">
            
                    
                        <b>1.10.2.</b>
                    
                    Structured output formatting
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10.3" data-path="tool-call-and-function-call-message-handling.html">
            
                <a href="tool-call-and-function-call-message-handling.html">
            
                    
                        <b>1.10.3.</b>
                    
                    Tool Call and Function Call Message Handling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../multimodal-and-vision-capabilities/">
            
                <a href="../multimodal-and-vision-capabilities/">
            
                    
                        <b>1.11.</b>
                    
                    Multimodal and Vision Capabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../multimodal-and-vision-capabilities/vision-models-and-integration.md">
            
                <span>
            
                    
                        <b>1.11.1.</b>
                    
                    Vision models and integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../multimodal-and-vision-capabilities/image-processing-and-analysis.md">
            
                <span>
            
                    
                        <b>1.11.2.</b>
                    
                    Image processing and analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../multimodal-and-vision-capabilities/multimodal-agent-workflows.md">
            
                <span>
            
                    
                        <b>1.11.3.</b>
                    
                    Multimodal agent workflows
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../agent-capabilities-and-composability/">
            
                <a href="../agent-capabilities-and-composability/">
            
                    
                        <b>1.12.</b>
                    
                    Agent Capabilities and Composability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../agent-capabilities-and-composability/agent-capability-definition.md">
            
                <span>
            
                    
                        <b>1.12.1.</b>
                    
                    Agent capability definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../agent-capabilities-and-composability/capability-composition.md">
            
                <span>
            
                    
                        <b>1.12.2.</b>
                    
                    Capability composition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../agent-capabilities-and-composability/capability-discovery-and-routing.md">
            
                <span>
            
                    
                        <b>1.12.3.</b>
                    
                    Capability discovery and routing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../group-and-swarm-agent-patterns/">
            
                <a href="../group-and-swarm-agent-patterns/">
            
                    
                        <b>1.13.</b>
                    
                    Group and Swarm Agent Patterns
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../group-and-swarm-agent-patterns/group-agent-coordination.md">
            
                <span>
            
                    
                        <b>1.13.1.</b>
                    
                    Group agent coordination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../group-and-swarm-agent-patterns/swarm-intelligence-patterns.md">
            
                <span>
            
                    
                        <b>1.13.2.</b>
                    
                    Swarm intelligence patterns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../group-and-swarm-agent-patterns/distributed-agent-systems.md">
            
                <span>
            
                    
                        <b>1.13.3.</b>
                    
                    Distributed agent systems
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../practical-pitfalls-and-best-practices/">
            
                <a href="../practical-pitfalls-and-best-practices/">
            
                    
                        <b>1.14.</b>
                    
                    Practical Pitfalls and Best Practices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../practical-pitfalls-and-best-practices/error-handling-in-agent-orchestration.html">
            
                <a href="../practical-pitfalls-and-best-practices/error-handling-in-agent-orchestration.html">
            
                    
                        <b>1.14.1.</b>
                    
                    Error handling in agent orchestration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../practical-pitfalls-and-best-practices/security-considerations-for-code-execution.html">
            
                <a href="../practical-pitfalls-and-best-practices/security-considerations-for-code-execution.html">
            
                    
                        <b>1.14.2.</b>
                    
                    Security considerations for code execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../practical-pitfalls-and-best-practices/testing-and-logging-strategies.html">
            
                <a href="../practical-pitfalls-and-best-practices/testing-and-logging-strategies.html">
            
                    
                        <b>1.14.3.</b>
                    
                    Testing and logging strategies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Tool Call and Function Call Message Handling</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="tool-call-and-function-call-message-handling">Tool call and function call message handling</h1>
<h2 id="overview">Overview</h2>
<p>Tool call and function call message handling refers to the process by which Large Language Models (LLMs) are empowered to interact with external functions, APIs, or "tools" during a conversation. By defining and registering functions with a JSON schema, developers can enable LLMs to produce structured outputs that trigger specific actions, such as querying databases, fetching information, or performing calculations. This process involves configuring the LLM to recognize tool calls, formatting responses for downstream consumption, and managing the full message flow between user, model, and tools.</p>
<hr></hr>
<h2 id="explanation">Explanation</h2>
<h3 id="1-defining-and-registering-functions">1. Defining and Registering Functions</h3>
<p>To enable LLMs to call functions, each function (or "tool") must be registered with a schema that defines its name, description, and parameters using JSON Schema. This schema informs the model about what functions are available, their arguments, and how to format calls.</p>
<p><strong>Example schema:</strong></p>
<pre><code class="lang-json">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"get_weather"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"Retrieve current weather information for a city."</span>,
  <span class="hljs-string">"parameters"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
    <span class="hljs-string">"properties"</span>: {
      <span class="hljs-string">"city"</span>: {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"Name of the city"</span>
      }
    },
    <span class="hljs-string">"required"</span>: [<span class="hljs-string">"city"</span>]
  }
}
</code></pre>
<h3 id="2-configuring-structured-outputs">2. Configuring Structured Outputs</h3>
<p>When configured for structured outputs, the LLM returns a special output format (often as a JSON object or via a specific message protocol). This output includes details about the function to call and its arguments, rather than plain text.</p>
<p><strong>Example output:</strong></p>
<pre><code class="lang-json">{
  <span class="hljs-string">"tool_calls"</span>: [
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"get_weather"</span>,
      <span class="hljs-string">"arguments"</span>: {
        <span class="hljs-string">"city"</span>: <span class="hljs-string">"Paris"</span>
      }
    }
  ]
}
</code></pre>
<h3 id="3-message-flow-management">3. Message Flow Management</h3>
<p>The typical message flow for tool/function calling is:</p>
<ol>
<li><p><strong>User sends input:</strong><br></br>E.g., "What's the weather in Paris?"</p>
</li>
<li><p><strong>LLM responds with tool call:</strong>  </p>
<ul>
<li>Structured output indicating which tool to invoke and with what arguments.</li>
</ul>
</li>
<li><p><strong>Application invokes tool:</strong>  </p>
<ul>
<li>Backend extracts tool call from model output.</li>
<li>Calls the corresponding registered function with provided arguments.</li>
</ul>
</li>
<li><p><strong>Application returns results to LLM (optional):</strong>  </p>
<ul>
<li>Sends results back to LLM as a function result message for further reasoning or response synthesis.</li>
</ul>
</li>
<li><p><strong>LLM produces final user-facing response:</strong>  </p>
<ul>
<li>E.g., "The weather in Paris is 22Â°C and sunny."</li>
</ul>
</li>
</ol>
<hr></hr>
<h2 id="examples">Examples</h2>
<h3 id="python-example-using-openai-api">Python Example Using OpenAI API</h3>
<h4 id="registering-a-function">Registering a function</h4>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

client = OpenAI()

functions = [
    {
        <span class="hljs-string">"name"</span>: <span class="hljs-string">"get_weather"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"Retrieve current weather information for a city."</span>,
        <span class="hljs-string">"parameters"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-string">"properties"</span>: {
                <span class="hljs-string">"city"</span>: {
                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Name of the city"</span>
                }
            },
            <span class="hljs-string">"required"</span>: [<span class="hljs-string">"city"</span>]
        }
    }
]
</code></pre>
<h4 id="sending-a-tool-call-enabled-request">Sending a tool call enabled request</h4>
<pre><code class="lang-python">response = client.chat.completions.create(
    model=<span class="hljs-string">"gpt-4-0613"</span>,
    messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"What's the weather in Paris?"</span>}],
    tools=functions,
    tool_choice=<span class="hljs-string">"auto"</span>  <span class="hljs-comment"># or specify a tool if needed</span>
)

tool_calls = response.choices[<span class="hljs-number">0</span>].message.tool_calls
</code></pre>
<h4 id="handling-the-tool-call">Handling the tool call</h4>
<pre><code class="lang-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city</span>):
    <span class="hljs-comment"># Dummy function for demonstration</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"The weather in <span class="hljs-subst">{city}</span> is 22Â°C and sunny."</span>

<span class="hljs-keyword">for</span> call <span class="hljs-keyword">in</span> tool_calls:
    <span class="hljs-keyword">if</span> call.name == <span class="hljs-string">"get_weather"</span>:
        result = get_weather(**call.arguments)
        <span class="hljs-comment"># Send function result back to the LLM if further reasoning is desired</span>
        <span class="hljs-comment"># Or format the final response for the user</span>
</code></pre>
<h3 id="message-flow-diagram">Message Flow Diagram</h3>
<pre><code class="lang-text">User Input  --&gt;  LLM (Tool Call Output)  --&gt;  App (Tool Invocation)  --&gt;  LLM (Optional Reasoning)  --&gt;  Final Response
</code></pre>
<hr></hr>
<h2 id="best-practices">Best Practices</h2>
<ul>
<li><strong>Define clear, unambiguous schemas:</strong> Use descriptive names and parameter descriptions to help the LLM choose and populate tools correctly.</li>
<li><strong>Validate input and output:</strong> Always validate that the LLM's tool call arguments match your schema before invoking a function.</li>
<li><strong>Handle errors gracefully:</strong> Prepare for missing or malformed arguments, tool failures, or ambiguous LLM responses.</li>
<li><strong>Limit tool exposure:</strong> Only register functions that should be accessible to the model to minimize risk.</li>
<li><strong>Chain tool calls carefully:</strong> If using multiple tools or multi-step reasoning, manage message state and context explicitly.</li>
<li><strong>Monitor usage:</strong> Log tool calls and monitor for unexpected or malicious use.</li>
<li><strong>Version your schemas:</strong> If your function signatures change, version them to maintain backward compatibility.</li>
</ul>
<hr></hr>
<h2 id="related-concepts">Related Concepts</h2>
<ul>
<li><a href="#">Structured Outputs with LLMs</a>  </li>
<li><a href="#">LLM Configuration and Model Clients</a></li>
<li><a href="#">Tools and Dependency Injection</a></li>
<li><a href="https://platform.openai.com/docs/guides/function-calling" target="_blank">Function Calling in OpenAI API</a></li>
<li><a href="https://json-schema.org/" target="_blank">JSON Schema</a></li>
<li><a href="#">Prompt Engineering for Tool Use</a></li>
<li><a href="#">Chaining and Orchestration with LLMs</a></li>
</ul>
<hr></hr>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="structured-output-formatting.html" class="navigation navigation-prev " aria-label="Previous page: Structured output formatting">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../multimodal-and-vision-capabilities/" class="navigation navigation-next " aria-label="Next page: Multimodal and Vision Capabilities">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Tool Call and Function Call Message Handling","level":"1.10.3","depth":2,"next":{"title":"Multimodal and Vision Capabilities","level":"1.11","depth":1,"path":"chapters/multimodal-and-vision-capabilities/README.md","ref":"chapters/multimodal-and-vision-capabilities/README.md","articles":[{"title":"Vision models and integration","level":"1.11.1","depth":2,"path":"chapters/multimodal-and-vision-capabilities/vision-models-and-integration.md","ref":"chapters/multimodal-and-vision-capabilities/vision-models-and-integration.md","articles":[]},{"title":"Image processing and analysis","level":"1.11.2","depth":2,"path":"chapters/multimodal-and-vision-capabilities/image-processing-and-analysis.md","ref":"chapters/multimodal-and-vision-capabilities/image-processing-and-analysis.md","articles":[]},{"title":"Multimodal agent workflows","level":"1.11.3","depth":2,"path":"chapters/multimodal-and-vision-capabilities/multimodal-agent-workflows.md","ref":"chapters/multimodal-and-vision-capabilities/multimodal-agent-workflows.md","articles":[]}]},"previous":{"title":"Structured output formatting","level":"1.10.2","depth":2,"path":"chapters/structured-outputs-and-tool-calling-with-llms/structured-output-formatting.md","ref":"chapters/structured-outputs-and-tool-calling-with-llms/structured-output-formatting.md","articles":[]},"dir":"ltr"},"config":{"plugins":["theme-default","highlight","fontsettings","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true,"showSummary":true},"highlight":{},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false}},"theme":"default","author":"AutoGen Team","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Agentic Documentation","language":"en","gitbook":"*"},"file":{"path":"chapters/structured-outputs-and-tool-calling-with-llms/tool-call-and-function-call-message-handling.md","mtime":"2025-05-24T00:27:00.023Z","type":"markdown"},"gitbook":{"version":"6.0.3","time":"2025-05-24T00:27:11.294Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/@honkit/honkit-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/@honkit/honkit-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

